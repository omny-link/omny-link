      <script type="text/javascript">
        function sendMail() {
          $('.p-messages').empty().append('Sending...').show();
          $p.sendMessage('inOnly','com.knowprocess.mail.MailData.json',JSON.stringify($p.mail));
        }
        jQuery(document).ready(function() {
          console.debug('Document ready handler...');
          loadTemplates();
        });
        function loadTemplates() {
          jQuery.getJSON(
              "/wp-content/plugins/syncapt/emails/templates.php", 
              function(templates) {
                console.debug("Have "+templates.length+" templates: "+templates);
                jQuery('#templates-ctl').empty();
                for (idx in templates) { 
                  jQuery('#templates-ctl').append('<option name="'+templates[idx]+'">'+templates[idx]+'</option>');
                }
              });
        };
      </script>
      <form id="mailForm" class="" role="form">
      
        <div class="p-messages" style="display:none;color:#0B527E"> </div>

        <div id="mailDetails">
          <p>All fields are mandatory.</p> 
            <input class="form-control decorate" data-p-bind="$p.mail.contact.firstName" type="text" name="First Name" placeholder="First Name*" required title="Please enter your first name"/><br />
            <input class="form-control decorate" data-p-bind="$p.mail.contact.email" type="email" name="Email" placeholder="Email Address*" required class="email" title="Please enter your email address"/><br />
            <input class="form-control decorate" data-p-bind="$p.mail.subject" name="Subject Line" type="text" id="subject" placeholder="Subject Line*" required title="Please enter the subject line for the email"/><br/>
            <select class="form-control decorate" data-p-bind="$p.mail.template" id="templates-ctl" name="Template" required title="Please select the email template to send">
              <option name=""> -- Please select --</option>
            </select>
          <!-- Requires jquery autocomplete which is not yet available 
          <input data-p-combo="app.templates" data-p-combo-bind="$p.mail.accountInfo.region.id" data-p-combo-display="$p.mail.accountInfo.region.name" data-p-l10n="true" name="bregion" type="text" id="bregion" placeholder="Choose Location" title="Please choose your business location, if more than one, then select your Head Office location"/>-->
        </div>
        <div>
          <input data-p-action="sendMail();" type="button" value="Send mail" id="send" class="btn btn-fwd">
        </div>
    </form>
             

