      <style>
       .btn-bar { 
         margin-bottom: 20px;
       }
       .col { 
         border: 1px solid #999;
         padding:10px;
         width:46%
       }
       .col-left { 
         float:left;
       }
       .col-right { 
         padding-left:4%;
         float:right;
       }
       fieldset { 
         padding-bottom:10px; 
       }
       input,textarea { 
         width: 100%;
       }
       input[type="radio"],input[type="checkbox"] { 
         width: 10%;
       }
       input[type="button"],input[type="reset"],input[type="submit"] { 
         width: 30%;
       }
      </style>
      <script type="text/javascript">
        function addQuestion(type) {
          if (type == undefined) type = 'question';
          var idx = $p.survey.questions.length;
          console.log('Invoked addQuestion of type: '+type+' at idx: '+idx);
          $p.survey.questions[idx] = new Object();
          $p.survey.questions[idx].idx = idx;
          $('#surveyDesign').append('<div id="question'+idx+'"></div>');
          $('#surveyDesign #question'+idx).html($('#'+type+'Template').html()).moustache($p.survey.questions[idx]);
          $('<div id="previewQ'+idx+'"></div>').insertBefore('#surveyPreview #submitSurvey');
          $('#surveyPreview #previewQ'+idx).html($('#'+type+'PreviewTemplate').html()).moustache($p.survey.questions[idx]);
          $p.bindControls();
          $p.sync();
        }
        function saveSurvey() {
          $('.p-messages').empty().append('Sending...').show();
          $('.btn').attr('disabled','disabled').addClass('p-disabled');
          $p.sendMessage('inOnly','com.knowprocess.survey.Survey.json',JSON.stringify($p.survey))
            .done(function(data) {
              $('.p-messages').addClass('p-success');
            });
        }
        jQuery(document).ready(function() {
          $p.survey = new Object();
          if ($p.survey.questions == undefined) $p.survey.questions = [];
        });
      </script>

      <div id="questionTemplate" style="display:none">
        <fieldset>
          <input class="decorate" data-p-bind="$p.survey.questions[{{idx}}].question" type="text" id="question" name="Question" placeholder="Type your question here" required title="Please enter the survey question"/>
        </fieldset>
      </div>
        
      <div id="multiChoiceQTemplate" style="display:none">
        <fieldset>
          <input class="decorate" data-p-bind="$p.survey.questions[{{idx}}].question" type="text" id="question" name="Question" placeholder="Type your question here" required title="Please enter the survey question"/>
          <input class="decorate" data-p-bind="$p.survey.questions[{{idx}}].answer1" type="text" id="answer1" name="Answer 1" placeholder="" required title=""/>
          <input class="decorate" data-p-bind="$p.survey.questions[{{idx}}].answer2" type="text" id="answer2" name="Answer 2" placeholder="" required title=""/>
          <input class="decorate" data-p-bind="$p.survey.questions[{{idx}}].answer3" type="text" id="answer3" name="Answer 3" placeholder="" required title=""/>
        </fieldset>
      </div>

      <div id="questionPreviewTemplate" style="display:none">
        <fieldset>
          <label data-p-display="$p.survey.questions[{{idx}}].question" id="question" name="Question"></label>
          <textarea data-p-bind="$p.survey.questions[{{idx}}].response" id="response" name="response" rows="3"> </textarea>
        </fieldset>
      </div>

      <div id="multiChoiceQPreviewTemplate" style="display:none">
        <fieldset>
          <div class="field-group">
          <label data-p-display="$p.survey.questions[{{idx}}].question" type="text" id="question" name="Question" placeholder="Type your question here" required title="Please enter the survey question"></label>
          </div>
          <div class="field-group">
          <label data-p-display="$p.survey.questions[{{idx}}].answer1"></label>
          <input data-p-bind="$p.survey.questions[{{idx}}].answer1" type="radio" name="response" id="optionsRadios1" value="option1" checked>
          </div>
          <div class="field-group">
          <label data-p-display="$p.survey.questions[{{idx}}].answer2"></label>
          <input data-p-bind="$p.survey.questions[{{idx}}].answer2" type="radio" name="response" id="optionsRadios2" value="option2">
          </div>
          <div class="field-group">
          <label data-p-display="$p.survey.questions[{{idx}}].answer3"></label>
          <input data-p-bind="$p.survey.questions[{{idx}}].answer3" type="radio" name="response" id="optionsRadios2" value="option2">
          </div>
        </fieldset>
      </div>

      <form id="surveyForm" class="" role="form">
      
        <div class="p-messages" style="display:none;"> </div>
        <div class="btn-bar">
          <input data-p-action="addQuestion('multiChoiceQ');" type="button" value="Add Multi-Choice Question" class="btn">
          <input data-p-action="addQuestion();" type="button" value="Add Question" class="btn">
          <input data-p-action="saveSurvey();" type="button" value="Save Survey" id="send" class="btn btn-fwd">
        </div>

        <div class="col col-left" id="surveyDesign">
          <h2>Design Pane</h2>
          <fieldset>
            <input class="decorate" data-p-bind="$p.survey.name" type="text" id="name" name="Name" placeholder="Name*" required title="Please enter the survey name"/>
          </fieldset>
        </div>

        <div class="col col-right" id="surveyPreview">
          <h2>Preview Pane: <span data-p-display="$p.survey.name"></span></h2>
          <p>Fields marked <span class="mandatory">*</span> are mandatory.</p> 
          <input data-p-action="submitSurvey();" type="button" value="Submit" id="submitSurvey" class="btn btn-fwd">
        </div>
    </form>
             

