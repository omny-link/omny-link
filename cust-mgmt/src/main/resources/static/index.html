<!doctype html>
<html lang='en-GB'>
<head>
  <meta charset='utf-8'>
  <title>Customer Management</title>
  <!-- 
  <link href='http://fonts.googleapis.com/css?family=Poiret+One' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Lato:400italic,400' rel='stylesheet' type='text/css'>
  -->
  <link href='http://fonts.googleapis.com/css?family=Roboto:400italic,400,700' rel='stylesheet' type='text/css'>
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <link href="css/omny-0.1.0.css" rel="stylesheet">
  <link rel="icon" type="image/png" href="images/icon/omny-icon-16x16.png" />
</head>

<!--
  1. This is the element we'll render our Ractive to.
-->
<body class="container" id="container">

  <!--
       2. You can load a template in many ways. For convenience, we'll include it in
       a script tag so that we don't need to mess around with AJAX or multiline strings.
       Note that we've set the type attribute to 'text/ractive' - though it can be
       just about anything except 'text/javascript'
  -->
  <script id='template' type='text/ractive'>
    <h1>
      <a class="nav navbar-brand" href="http://omny.link">
        <img src="/images/omny-logo.png" alt="logo"/>
      </a>
      <span>Customer Management</span>
    </h1>
    <div class="clearfix" id="messages">
       <p class=" bg-danger text-danger">Beta! Please ensure you have backups!</p>
    </div>
    
    <form id="contactList">
      <section id="contactsSect">
        <h2>
          <span>Contacts</span>
          <span class="clickable glyphicon glyphicon-plus" aria-hidden="true" onclick="ractive.add()"></span>
          <input type="search" class="form-control search" placeholder="Search">
       </h2>
        <table id="contactsTable" class="table table-striped">
          <thead>
            <tr>
              <th></th>
              <th>Stage</th>
              <th>Full Name</th>
              <th>Owned by</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
          {{#each contacts:i}}
            <tr data-href="{{_links.self.href}}" on-click="edit(this)">
              <td>{{i+1}}</td>
              <td>{{stage}}</td>
              <td>{{title}} {{firstName}} {{lastName}}</td>
              <td>{{contact}}</td>
              <td>
                <span class="clickable glyphicon glyphicon-remove" aria-hidden="true" onclick="ractive.delete('{{_links.self.href}}')"></span>
                <span class="clickable glyphicon glyphicon-pencil" aria-hidden="true" on-click="select('{{_links.self.href}}')"></span>
              </td>
            </tr>
          {{/each}}
          </tbody>
        </table>
      </section>

      <section id="currentSect" style="display:none">
        <form id="currentForm">
        <div class="form create-form">
          <input class="col-xs-1" id="curTitle" placeholder="Title" required value="{{current.title}}"/>
          <input class="col-xs-2" id="curFirstName" placeholder="First Name" required value="{{current.firstName}}"/>
          <input class="col-xs-2" id="curLastName" placeholder="Last Name" required value="{{current.lastName}}"/>
          <input class="col-xs-2 typeahead pull-right" id="curOwner" placeholder="Owner" required value="{{current.contact}}"/>
        </div>
        <h2 class="form create-form">&nbsp;</h2>
        <h2 class="form edit-form">
          <span>{{current.title}} {{current.firstName}} {{current.lastName}}</span>
          <span style="float:right;font-style:italic">Owner: {{current.contact}}</span>
        </h2>

        <div id="currentBody" class="col-md-6">
          <ul class="form edit-form">
            <li><label>Email:</label><input id="curEmail" required value="{{current.email}}"></li>
            <li class=""><label>Land line:</label><input id="curLandLine" value="{{current.landLine}}"></li>
            <li><label>Address:</label><input id="curAddress1" value="{{current.address1}}"/>
            <li><label></label><input id="curAddress2" value="{{current.address2}}"/>
            <li><label></label><input id="curCountyOrCity" value="{{current.countyOrCity}}"/></li>
            <li><label>Post Code:</label><input id="curPostCode" value="{{current.postCode}}"></li>
          </ul>
        </div>
        <div class="col-md-6">
          <ul class="form edit-form">
            <li><label>Enquiry Type:</label><input id="curEnquiryType" value="{{current.enquiryType}}"></li>
            <li><label>Budget:</label><input id="curBudget" value="{{current.budget}}"></li>
            <li><label>Stage:</label><input class="typeahead" id="curStage" value="{{current.stage}}"></li>
            <li><label>Source:</label><input class="typeahead" id="curSource" value="{{current.source}}"></li>
            <li><label>Medium:</label><input class="typeahead" id="curMedium" value="{{current.medium}}"></li>
          </ul>
        </div>
        </form>

        <div class="col-md-12">
          <h2>
            <span>Notes</span>
            <span class="clickable glyphicon glyphicon-plus" aria-hidden="true" onclick="ractive.addNote('{{current._links.self.href}}')"></span>
          </h2>
          <table id="notesTable" class="table table-striped"><tbody>
            <tr style="display:none;">
              <td colspan="3">
                <textarea id="note" on-blur="saveNote()" placeholder="Type your note here" required style="width:100%;"></textarea>
                <br/>
                <a onclick="$('#notesTable tr:nth-child(1)').slideUp();">Cancel</a>
              </td>
            </tr>
            {{#each current.notes:j}}
              <tr>
                <td>{{created}}</td>
                <td>{{author}}</td>
                <td>{{content}}</td>
              </tr>
            {{/each}}
          </tbody></table>
        </div>
      
        <div class="col-md-12">
          <h2>
            <span>Documents</span>
            <span class="clickable glyphicon glyphicon-plus" aria-hidden="true" onclick="ractive.addDoc('{{current._links.self.href}}')"></span>
          </h2>
          <table id="docsTable" class="table table-striped"><tbody>
            <tr style="display:none;">
              <td colspan="3">
                <input id="doc" on-blur="saveDoc()" placeholder="Paste document link here" required style="width:100%;"/>
                <br/>
                <a onclick="$('#docsTable tr:nth-child(1)').slideUp();">Cancel</a>
              </td>
            </tr>
            {{#each current.documents:k}}
              <tr>
                <td>{{created}}</td>
                <td>{{author}}</td>
                <td>{{url}}</td>
              </tr>
            {{/each}}
          </tbody></table>
        </div>
      </section>

    </form>
  </script>

  <script id='template' type='text/ractive'>
  </script>  

  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="js/jquery-1.11.0.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/bootstrap.min.js"></script>
  <script src="js/bootstrap3-typeahead.js"></script>
  <!--
       3. You can always get the most recent stable version from the URL below.
       If you want the newest features, use the 'edge' version instead:

           http://cdn.ractivejs.org/edge/ractive.min.js

       If you need IE8 support, change 'ractive' to 'ractive-legacy'.
  -->
  <script src="js/ractive.min.js"></script>
  <script src="js/custmgmt-0.1.0.js"></script>
</body>
</html>
